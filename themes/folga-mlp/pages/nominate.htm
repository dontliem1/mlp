title = "Заявка на участие в Премии"
url = "/nominate"
layout = "default"
description = "Расскажи о событиях и проектах, которые ты посетил(а) или организовывала и номинируй их на молодежную лидерскую премию."
==
<?php
// use Folga\Mlp\Models\Req;

// function onSubmitOrderForm()
// {
//     $params = [];
//     $keys = ['name', 'birthday', 'city', 'job', 'contact', 'achievements', 'level', 'title', 'team', 'social', 'project1', 'about1', 'start1', 'finish1', 'area1', 'geography1', 'quantity1', 'achievements1', 'social1', 'media1', 'vk1', 'project2', 'about2', 'start2', 'finish2', 'area2', 'geography2', 'quantity2', 'achievements2', 'social2', 'media2', 'vk2', 'project3', 'about3', 'start3', 'finish3', 'area3', 'geography3', 'quantity3', 'achievements3', 'social3', 'media3', 'vk3'];
//     foreach ($keys as $key) {
//         if (in_array($key, ['start2', 'finish2', 'start3', 'finish3']) && empty(post($key))) {
//             continue;
//         }

//         $params[$key] = post($key);
//     }
//     Req::create($params);
    // Mail::sendTo('YouthLeaderAward@yandex.ru', 'folga.mlp::mail.nominate', $params);
// }
?>
==
{# {% if 'now'|date() >= '2022-11-18T19:00'|date() %} #}
<main class="container">
    <h1>Приём заявок завершён!</h1>
</main>
{# {% else %} #}
{# <main class="container">
    <h1>Расскажи о событии или проекте</h1>
    {{ form_open({ method: 'post', id: 'awardForm' }) }}
        <fieldset>
            <legend class="section-heading">Лидер</legend>
            <p class="award-form__row">
                {{ form_label('name', 'ФИО', {'class': 'award-form__label'}) }}
                {{ form_text('name', '', {'class': 'award-form__input', 'placeholder': 'Иванова Мария Сергеевна', 'required': '', 'maxlength': 255}) }}
            </p>
            <p class="award-form__row">
                {{ form_label('birthday', 'Дата рождения', {'class': 'award-form__label'}) }}
                {{ form_input('date', 'birthday', '', {'class': 'award-form__input', 'max': 'now'|date('Y-m-d'), 'required': ''}) }}
            </p>
            <p class="award-form__row">
                {{ form_label('city', 'Место проживания', {'class': 'award-form__label'}) }}
                {{ form_text('city', '', {'class': 'award-form__input', 'placeholder': 'Тюмень', 'required': '', 'maxlength': 255}) }}
            </p>
            <p class="award-form__row">
                {{ form_label('job', 'Место работы и должность / место учебы, направление и курс обучения', {'class': 'award-form__label'}) }}
                {{ form_text('job', '', {'class': 'award-form__input', 'placeholder': 'ООО «Компания», менеджер', 'required': ''}) }}
            </p>
            <p class="award-form__row">
                {{ form_label('contact', 'Контактные данные (мобильный телефон, ссылка на ВКонтакте)', {'class': 'award-form__label'}) }}
                {{ form_textarea('contact', '', {'class': 'award-form__input', 'placeholder': '+7 999 999-99-99, https://vk.com/1', 'required': '', 'rows': 2}) }}
            </p>
            <p class="award-form__row">
                {{ form_label('achievements', 'Достижения', {'class': 'award-form__label'}) }}
                {{ form_textarea('achievements', '', {'class': 'award-form__input', 'placeholder': 'Награды, знаки отличия, иные значимые достижения', 'required': '', 'rows': 4}) }}
            </p>
            <fieldset class="award-form__row">
                <legend class="award-form__label">Уровень проектного менеджмента</legend>
                <label>{{ form_radio('level', 'professional', true, {'class': 'award-form__input'}) }}<b>Профессиональный общественник / профи</b><br>неформальное сообщество или НКО, не менее 2-х лет опыта реализации социально-значимых инициатив; опыт реализации инициатив за счет средств всероссийских грантовых конкурсов</label>
                <label>{{ form_radio('level', 'beginner', false, {'class': 'award-form__input'}) }}<b>Начинающий общественник / дебютант</b><br>неформальное сообщество или НКО, менее 2-х лет опыта реализации социально-значимых инициатив; опыт реализации инициатив за счет грантовой поддержки региона, без грантовой поддержки</label>
            </fieldset>
        </fieldset>

        <fieldset>
            <legend class="section-heading">Команда</legend>
            <p class="award-form__row">
                {{ form_label('title', 'Название', {'class': 'award-form__label'}) }}
                {{ form_text('title', '', {'class': 'award-form__input', 'placeholder': 'Неформальное объединение / НКО', 'required': '', 'maxlength': 255}) }}
            </p>
            <p class="award-form__row">
                {{ form_label('team', 'ФИО участников команды', {'class': 'award-form__label'}) }}
                {{ form_textarea('team', '', {'class': 'award-form__input', 'placeholder': 'Иванов Петр Васильевич, Пушкина Елена Михайловна', 'required': '', 'rows': 5}) }}
            </p>
            <p class="award-form__row">
                {{ form_label('social', 'Социальные сети команды', {'class': 'award-form__label'}) }}
                {{ form_textarea('social', '', {'class': 'award-form__input', 'placeholder': 'ВКонтакте, Одноклассники и др. при наличии', 'required': '', 'rows': 3}) }}
            </p>
        </fieldset>

        <fieldset>
            <legend class="section-heading">Инициатива (событие или проект)</legend>
            {% partial 'form' number=1 %}
        </fieldset>
        <details>
            <summary class="section-heading">Вторая инициатива (событие или проект)</summary>
            <fieldset>
                {% partial 'form' number=2 %}
            </fieldset>
        </details>
        <details>
        <summary class="section-heading">Третья инициатива (событие или проект)</summary>
            <fieldset>
                {% partial 'form' number=3 %}
            </fieldset>
        </details>

        {{ form_button('Подать заявку', { class: 'award-form__btn', type: 'submit' }) }}
        <br>
        <a href="{{ 'policy'|page }}" class="link--solid" target="_blank">Политика конфиденциальности</a>
			<div class="popup__success-message success-message form__message--success" hidden>
				<h3 class="success-message__title">Спасибо!</h3>
				<p class="success-message__text">Заявка успешно оставлена.</p>
			</div>
			<p class="success-message__text form__message--fail" hidden>Ошибка</p>
		{{ form_close() }}
</main>
{% put scripts %}
<script>
/**
 * Связка отправки формы с хендлером на сервере
 * @param {string} formId id формы
 * @param {string} handler название хендлера в PHP
 */
 function bindFormSubmitHandler(formId, handler) {
	const callbackForm = document.getElementById(formId);
	if (callbackForm) {
		callbackForm.addEventListener('submit', function (e) {
			e.preventDefault();

			const formElements = /** @type {HTMLCollectionOf<HTMLElement>} */ (callbackForm.children);
			/** @type {?HTMLButtonElement} */
			const submitBtn = callbackForm.querySelector('.award-form__btn');
			/** @type {?HTMLParagraphElement} */
			const formMessageFail = callbackForm.querySelector('.form__message--fail');
			if (submitBtn) {
				submitBtn.disabled = true;
			}
			if (formMessageFail) {
				formMessageFail.hidden = true;
			}
			// @ts-ignore
			Snowboard.request(callbackForm, handler, {
				success() {
					for (const element of formElements) {
						element.hidden = !element.classList.contains('form__message--success');
					}
				},
				/**
				 * @param {string} errorMessage
				 */
				handleErrorMessage(errorMessage) {
					if (formMessageFail) {
						if (errorMessage) {
							const formMessageFailTitle = formMessageFail.querySelector('b');
							if (formMessageFailTitle) {
								formMessageFailTitle.innerText = errorMessage;
							}
						}
						formMessageFail.hidden = false;
					}
				},
				complete() {
					if (submitBtn) {
						submitBtn.disabled = false;
					}
					callbackForm.scrollIntoView();
				}
			});

			if (formId === 'subscribeForm') {
				for (const element of formElements) {
					element.hidden = !element.classList.contains('form__message--success');
				}
			}
		});
	}
}
bindFormSubmitHandler('awardForm', 'onSubmitOrderForm');
</script>
{% endput %}
{% snowboard request %}
{% endif %} #}
